refactor: Migrate codebase to TypeScript and improve test suite